# Try to remove the `PS1` option from bashrc config. The config contains only
# the commented `PS1` option, so there is nothing to remove and the config
# should be not changed during this test.

- set_fact:
    tests: "{{ playbook_dir | regex_search('.*?/tests') }}"

- set_fact:
    module_tests: "{{ tests }}/integration/targets/config_option"

- set_fact:
    source_config: "{{ module_tests }}/res/bashrc"
    test_config: "{{ playbook_dir }}/bashrc"

- name: "Copy the test config to modify it during tests"
  copy:
    src: "{{ source_config }}"
    dest: "{{ test_config }}"
    force: true


- name: "Remove PS1 option"
  local.uws.config_option:
    file: "{{ test_config }}"
    option: "PS1"
  register: result

- name: "TEST the config is not changed"
  assert:
    that:
      - result.changed == false
      - result.failed == false

