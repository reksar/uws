- name: "/>/ waybar config"
  vars:
    temperature: >-
      {{
        temperature_cli.stat.exists
        | ternary('custom/temperature', 'temperature')
      }}
    temperature_module: >-
      {{
        lookup(
          'template',
          'module/'
            + temperature_cli.stat.exists
              | ternary('temperature', 'temperature_default')
            + '.jsonc',
          variable_start_string="<<",
          variable_end_string=">>",
        )
      }}
  template:
    src: "hyprland.{{ config_name }}"
    dest: "{{ config_dir }}/{{ config_name }}"
    variable_start_string: "<<"
    variable_end_string: ">>"
  register: config_status

- name: "/>/ waybar style"
  copy:
    src: "hyprland.{{ style_name }}"
    dest: "{{ config_dir }}/{{ style_name }}"
  register: style_status

- debug:
    msg: "Handle waybar status"
  changed_when: >
    waybar_status.changed
      or config_status.changed
      or style_status.changed
      or temperature_script_status.changed
  notify: "Restart waybar"
